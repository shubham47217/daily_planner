<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Day Planner</title>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0f0f0f, #1a1a1a);
      color: #fff;
      display: flex;
      justify-content: center;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 800px;
    }
    h1 {
      text-align: center;
      color: #00e0ff;
      text-shadow: 0 0 12px #00e0ff;
      margin-bottom: 20px;
    }
    .task-input {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
      background: #111;
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0, 224, 255, 0.2);
    }
    .task-input input, .task-input button {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
    }
    .task-input input {
      background: #1f1f1f;
      color: #fff;
    }
    .task-input button {
      background: linear-gradient(135deg, #00e0ff, #0088ff);
      color: white;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .task-input button:hover {
      transform: scale(1.05);
    }
    .day-group {
      margin-bottom: 25px;
    }
    .day-title {
      font-size: 18px;
      color: #ff4081;
      margin-bottom: 10px;
      text-shadow: 0 0 8px #ff4081;
    }
    .task {
      background: #181818;
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 12px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);
      transition: transform 0.2s;
    }
    .task:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 18px rgba(0, 224, 255, 0.25);
    }
    .task-title {
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 5px;
    }
    .task-details {
      font-size: 13px;
      opacity: 0.85;
      margin-bottom: 10px;
    }
    .controls button {
      margin-right: 8px;
      padding: 8px 12px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      color: #fff;
      transition: transform 0.2s;
    }
    .controls button:hover {
      transform: scale(1.08);
    }
    .start { background: #00c853; box-shadow: 0 0 10px #00c853; }
    .pause { background: #ff9800; box-shadow: 0 0 10px #ff9800; }
    .resume { background: #2196f3; box-shadow: 0 0 10px #2196f3; }
    .reset { background: #9c27b0; box-shadow: 0 0 10px #9c27b0; }
    .done { background: #4caf50; box-shadow: 0 0 10px #4caf50; }
    .delete { background: #f44336; box-shadow: 0 0 10px #f44336; }
    .edit { background: #607d8b; box-shadow: 0 0 10px #607d8b; }
    .stop-alarm { background: #ff1744; box-shadow: 0 0 10px #ff1744; }
    .status {
      display: inline-block;
      margin-left: 10px;
      padding: 2px 8px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: bold;
    }
    .active { background: #00c853; color: #fff; }
    .failed { background: #f44336; color: #fff; }
    .info {
      margin-top: 8px;
      font-size: 13px;
      color: #ccc;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>⏰ Day Planner</h1>
    <div class="task-input">
      <input type="text" id="taskTitle" placeholder="Task title (optional)">
      <input type="number" id="taskLimit" placeholder="Time limit (mins)">
      <button onclick="addTask()">Add Task ➕</button>
    </div>
    <div id="tasks"></div>
    <audio id="alarmSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" preload="auto"></audio>
  </div>

  <script>
    let tasks = [];
    let alarmTimeout;

    function addTask() {
      const title = document.getElementById('taskTitle').value || "Untitled Task";
      const limit = parseInt(document.getElementById('taskLimit').value) || 1;
      const date = new Date().toLocaleDateString();
      const task = { id: Date.now(), title, limit: limit*60, remaining: limit*60, started: null, running: false, failed: false };
      tasks.push(task);
      renderTasks();
      document.getElementById('taskTitle').value = '';
      document.getElementById('taskLimit').value = '';
    }

    function renderTasks() {
      const container = document.getElementById('tasks');
      container.innerHTML = '';
      const groups = {};
      tasks.forEach(t => {
        const date = new Date(t.id).toLocaleDateString();
        if (!groups[date]) groups[date] = [];
        groups[date].push(t);
      });

      for (let date in groups) {
        const dayDiv = document.createElement('div');
        dayDiv.className = 'day-group';
        const title = document.createElement('div');
        title.className = 'day-title';
        title.textContent = date;
        dayDiv.appendChild(title);
        groups[date].forEach(task => {
          const div = document.createElement('div');
          div.className = 'task';
          div.innerHTML = `
            <div class="task-title">${task.title} ${task.failed ? '<span class="status failed">FAILED</span>' : task.running ? '<span class="status active">ACTIVE</span>' : ''}</div>
            <div class="task-details">Limit: ${Math.round(task.limit/60)} mins</div>
            <div class="info">Started: ${task.started ? new Date(task.started).toLocaleTimeString() : 'Not started'}</div>
            <div class="info">Remaining: ${formatTime(task.remaining)} | Elapsed: ${formatTime(task.limit-task.remaining)}</div>
            <div class="controls">
              ${!task.running && !task.failed && task.remaining>0 ? `<button class="start" onclick="startTask(${task.id})">Start</button>` : ''}
              ${task.running ? `<button class="pause" onclick="pauseTask(${task.id})">Pause</button>` : ''}
              ${!task.running && task.remaining < task.limit && task.remaining>0 ? `<button class="resume" onclick="resumeTask(${task.id})">Resume</button>` : ''}
              <button class="reset" onclick="resetTask(${task.id})">Reset</button>
              <button class="done" onclick="doneTask(${task.id})">Done</button>
              <button class="edit" onclick="editTask(${task.id})">Edit</button>
              <button class="delete" onclick="deleteTask(${task.id})">Delete</button>
              ${task.failed ? '<button class="stop-alarm" onclick="stopAlarm()">Stop Alarm</button>' : ''}
            </div>
          `;
          dayDiv.appendChild(div);
        });
        container.appendChild(dayDiv);
      }
    }

    function startTask(id) {
      const task = tasks.find(t => t.id===id);
      if (!task) return;
      task.running = true;
      if (!task.started) task.started = Date.now();
      task.timer = setInterval(()=>tick(task),1000);
      renderTasks();
    }
    function pauseTask(id) {
      const task = tasks.find(t => t.id===id);
      if (!task) return;
      task.running = false;
      clearInterval(task.timer);
      renderTasks();
    }
    function resumeTask(id) { startTask(id); }
    function resetTask(id) {
      const task = tasks.find(t => t.id===id);
      if (!task) return;
      clearInterval(task.timer);
      task.remaining = task.limit;
      task.running = false;
      task.failed = false;
      task.started = null;
      renderTasks();
    }
    function doneTask(id) {
      tasks = tasks.filter(t => t.id!==id);
      renderTasks();
    }
    function deleteTask(id) { doneTask(id); }
    function editTask(id) {
      const task = tasks.find(t=>t.id===id);
      if (!task) return;
      const newTitle = prompt("Edit title", task.title);
      if (newTitle!==null) task.title=newTitle;
      const newLimit = prompt("Edit limit (minutes)", task.limit/60);
      if (newLimit!==null) { task.limit=newLimit*60; task.remaining=newLimit*60; }
      renderTasks();
    }
    function tick(task) {
      if (!task.running) return;
      task.remaining--;
      if (task.remaining<=0) {
        clearInterval(task.timer);
        task.failed=true;
        task.running=false;
        playAlarm();
      }
      renderTasks();
    }
    function formatTime(sec){
      const m=Math.floor(sec/60);const s=sec%60;return `${m}:${s.toString().padStart(2,'0')}`;
    }
    function playAlarm(){
      const alarm=document.getElementById('alarmSound');
      alarm.play();
      alarmTimeout=setTimeout(()=>alarm.pause(),120000);
    }
    function stopAlarm(){
      const alarm=document.getElementById('alarmSound');
      alarm.pause();
      alarm.currentTime=0;
      clearTimeout(alarmTimeout);
    }
  </script>
</body>
</html>
